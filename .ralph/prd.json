{
	"branchName": "ralph/beads-migration",
	"userStories": [
		{
			"id": "US-032",
			"title": "Create beads types module",
			"acceptanceCriteria": [
				"Create source/types/beads.ts with BeadsIssue type (id, title, type, status, priority, description, blockedBy, blocks, parent)",
				"Add EpicSummary type (id, title, progress, openCount, closedCount, hasBlockedTasks)",
				"Add BeadsCommandResult type for bd command output parsing",
				"Export types from source/types/index.ts",
				"typecheck passes"
			],
			"priority": 1,
			"passes": true,
			"notes": ""
		},
		{
			"id": "US-033",
			"title": "Create beads-reader module for bd command execution",
			"acceptanceCriteria": [
				"Create source/lib/beads-reader.ts module",
				"Function runBeadsCommand() to spawn bd process and parse JSON output",
				"Function getEpics() to list all epics with task counts and progress percentage",
				"Function getEpicTasks(epicId) to get all tasks within an epic (recursively for nested)",
				"Function getReadyTasks(epicId) to get unblocked tasks in epic",
				"Function getExternalBlockers(epicId) to get tasks outside epic that block tasks inside",
				"Function getIssueDetails(issueId) for full issue info",
				"Handle bd command failures gracefully with typed error results",
				"typecheck passes"
			],
			"priority": 2,
			"passes": true,
			"notes": ""
		},
		{
			"id": "US-034",
			"title": "Create useBeadsPolling hook for real-time status updates",
			"acceptanceCriteria": [
				"Create source/hooks/useBeadsPolling.ts hook",
				"Accept epicId and intervalMs (default 2500) parameters",
				"Poll beads state using getEpicTasks() at specified interval",
				"Return current tasks, loading state, and error state",
				"Clean up interval on unmount or when epicId changes",
				"Export from source/hooks/index.ts",
				"typecheck passes"
			],
			"priority": 3,
			"passes": true,
			"notes": ""
		},
		{
			"id": "US-035",
			"title": "Create EpicSelector TUI component",
			"acceptanceCriteria": [
				"Create source/components/EpicSelector.tsx component",
				"Display list of all epics from getEpics()",
				"Show epic title with visual progress bar for each",
				"Keyboard navigation with up/down arrows",
				"Enter key selects epic and calls onSelect callback",
				"Highlight current selection with inverse colors",
				"Show loading state while fetching epics",
				"Export from source/components/index.ts",
				"typecheck passes"
			],
			"priority": 4,
			"passes": true,
			"notes": ""
		},
		{
			"id": "US-036",
			"title": "Add branch management utilities",
			"acceptanceCriteria": [
				"Create source/utils/branch-utils.ts module",
				"Function slugifyTitle(title) to convert epic title to branch-safe format",
				"Function deriveBranchName(epicTitle) returning ralph/<slugified-title>",
				"Function getCurrentBranch() to get current git branch name",
				"Function branchExists(branchName) to check if branch exists locally",
				"Function createAndSwitchBranch(branchName, baseBranch) to create from main/master and switch",
				"Function getDefaultBranch() to detect main or master",
				"Function hasUncommittedChanges() to check for dirty worktree",
				"Export from source/utils/index.ts",
				"typecheck passes"
			],
			"priority": 5,
			"passes": true,
			"notes": ""
		},
		{
			"id": "US-037",
			"title": "Create TaskDetailPanel component",
			"acceptanceCriteria": [
				"Create source/components/TaskDetailPanel.tsx component",
				"Accept task: BeadsIssue prop for displaying details",
				"Show description with markdown checklist rendering",
				"Show blocked-by list with issue IDs and titles",
				"Show blocks list with issue IDs and titles",
				"Show current status with color coding (open=gray, in_progress=yellow, closed=green)",
				"Scrollable content for long descriptions",
				"Export from source/components/index.ts",
				"typecheck passes"
			],
			"priority": 6,
			"passes": false,
			"notes": ""
		},
		{
			"id": "US-038",
			"title": "Create ExternalBlockers collapsible section component",
			"acceptanceCriteria": [
				"Create source/components/ExternalBlockers.tsx component",
				"Accept blockers: BeadsIssue[] prop",
				"Show collapsible section header with count (e.g., 'External Blockers (3)')",
				"Toggle expand/collapse with keyboard (e or Enter when focused)",
				"When expanded, show list of blocking tasks from other epics",
				"Show each blocker with ID, title, and status",
				"Export from source/components/index.ts",
				"typecheck passes"
			],
			"priority": 7,
			"passes": false,
			"notes": ""
		},
		{
			"id": "US-039",
			"title": "Update TicketList for beads tasks with two-pane layout",
			"acceptanceCriteria": [
				"Modify source/components/TicketList.tsx to accept BeadsIssue[] instead of StoryWithStatus[]",
				"Update status display for beads statuses (open, in_progress, closed)",
				"Add selected task state and keyboard navigation",
				"Show task type indicator (task/bug/feature) with icons",
				"Show blocked indicator for tasks with dependencies",
				"Pass selected task to parent via onTaskSelect callback",
				"Integrate with two-pane layout (list on left, TaskDetailPanel on right)",
				"typecheck passes"
			],
			"priority": 8,
			"passes": false,
			"notes": ""
		},
		{
			"id": "US-040",
			"title": "Update MainLayout for epic-based workflow",
			"acceptanceCriteria": [
				"Modify source/components/MainLayout.tsx for beads integration",
				"Accept selectedEpic: EpicSummary and tasks: BeadsIssue[] props",
				"Show epic title in header area",
				"Left panel: TicketList with beads tasks",
				"Right panel: TaskDetailPanel when task selected, OutputPanel when running",
				"Add ExternalBlockers section below task list (collapsible)",
				"Handle view switching between task detail and output",
				"typecheck passes"
			],
			"priority": 9,
			"passes": false,
			"notes": ""
		},
		{
			"id": "US-041",
			"title": "Update setup-checker for beads requirement",
			"acceptanceCriteria": [
				"Modify source/utils/setup-checker.ts to check for .beads/ directory",
				"Remove prd.json existence check",
				"Add isBeadsInitialized check result",
				"Keep prompt.txt and progress.txt checks",
				"Update SetupCheckResult type for new checks",
				"typecheck passes"
			],
			"priority": 10,
			"passes": false,
			"notes": ""
		},
		{
			"id": "US-042",
			"title": "Update setup-scaffolding for beads initialization",
			"acceptanceCriteria": [
				"Modify source/utils/setup-scaffolding.ts",
				"Remove createPrdTemplate() function",
				"Add initializeBeads() function that prompts user and runs bd init",
				"Keep createRalphDirectory(), createPromptTemplate(), createProgressTemplate()",
				"Update scaffoldAll() to include beads initialization prompt",
				"Return result indicating if beads was initialized",
				"typecheck passes"
			],
			"priority": 11,
			"passes": false,
			"notes": ""
		},
		{
			"id": "US-043",
			"title": "Update SetupWizard for beads workflow",
			"acceptanceCriteria": [
				"Modify source/components/SetupWizard.tsx for beads",
				"Add beads initialization step with Y/N prompt",
				"Show .beads/ status in checklist instead of prd.json",
				"Run bd init when user confirms beads initialization",
				"Handle bd init failure gracefully with error message",
				"Update completion message for beads workflow",
				"typecheck passes"
			],
			"priority": 12,
			"passes": false,
			"notes": ""
		},
		{
			"id": "US-044",
			"title": "Update prompt template for beads workflow",
			"acceptanceCriteria": [
				"Modify source/templates/index.ts DEFAULT_PROMPT_TEMPLATE",
				"Include epic context: epic ID and title",
				"Add task selection strategy: prioritize unblocked, higher priority, dependencies first",
				"Instruct Claude to query beads: bd list --epic=<id> --status=open",
				"Instruct Claude to run bd update <task-id> --status=in_progress",
				"Instruct Claude to run bd close <task-id> on completion",
				"Add issue discovery instructions: use bd create, add as blocker if critical",
				"Keep AGENTS.md update instruction",
				"Keep progress.txt append instruction",
				"Add variable $EPIC_ID and $EPIC_TITLE for expansion",
				"typecheck passes"
			],
			"priority": 13,
			"passes": false,
			"notes": ""
		},
		{
			"id": "US-045",
			"title": "Rewrite iteration-executor for beads workflow",
			"acceptanceCriteria": [
				"Modify source/lib/iteration-executor.ts for beads",
				"Accept epicId parameter instead of PRD config",
				"Before each iteration: poll beads for ready tasks, skip if none ready (no Claude call)",
				"Generate prompt with epic context using updated template",
				"Remove story-based logic and detection",
				"Poll beads after iteration to detect status changes",
				"On task failure: add comment to issue using bd comments add",
				"When all epic tasks closed/blocked: auto-close epic with bd close",
				"Emit new events: noReadyTasks, taskComplete, epicComplete",
				"typecheck passes"
			],
			"priority": 14,
			"passes": false,
			"notes": ""
		},
		{
			"id": "US-046",
			"title": "Update App component for beads workflow",
			"acceptanceCriteria": [
				"Modify source/app.tsx for beads integration",
				"Add 'epic-select' to AppView type",
				"Show EpicSelector after setup complete",
				"On epic selection: derive branch, handle branch creation from main/master",
				"Warn about uncommitted changes before branch switch",
				"Store selected epic in state",
				"Use useBeadsPolling hook for real-time task updates",
				"Pass beads data to MainLayout",
				"After epic complete: prompt for next epic selection",
				"typecheck passes"
			],
			"priority": 15,
			"passes": false,
			"notes": ""
		},
		{
			"id": "US-047",
			"title": "Add session-end beads sync",
			"acceptanceCriteria": [
				"Modify source/app.tsx to run bd sync on exit",
				"Call sync in useEffect cleanup or on graceful exit",
				"If sync fails: log warning but exit successfully (silent continue)",
				"Show brief sync status in footer during sync",
				"typecheck passes"
			],
			"priority": 16,
			"passes": false,
			"notes": ""
		},
		{
			"id": "US-048",
			"title": "Update ralph-plan skill for beads",
			"acceptanceCriteria": [
				"Rewrite .claude/skills/ralph-plan/SKILL.md for beads workflow",
				"Change instructions to create epics with bd epic create or bd create --type=epic",
				"Support flexible nesting: epic > feature > sub-feature > task",
				"Use bd create --type=feature|task --parent=<epic-id> for children",
				"Set up dependencies with bd dep add",
				"Use markdown checklists in description for acceptance criteria",
				"Document priority 0-4 (0=critical, 4=backlog)",
				"Remove all prd.json references",
				"Update completion message for beads workflow"
			],
			"priority": 17,
			"passes": false,
			"notes": ""
		},
		{
			"id": "US-049",
			"title": "Remove deprecated prd.json code",
			"acceptanceCriteria": [
				"Delete source/lib/prd-reader.ts",
				"Delete source/lib/prd-writer.ts",
				"Delete source/lib/story-detector.ts",
				"Remove PRDConfig and UserStory types from source/types/prd.ts or delete file",
				"Remove story detection event handlers from app.tsx",
				"Remove prd-related exports from source/lib/index.ts",
				"Update any remaining imports to use beads modules",
				"typecheck passes"
			],
			"priority": 18,
			"passes": false,
			"notes": ""
		},
		{
			"id": "US-050",
			"title": "Update prompt-loader for beads variables",
			"acceptanceCriteria": [
				"Modify source/lib/prompt-loader.ts",
				"Add $EPIC_ID and $EPIC_TITLE variable expansion",
				"Update PromptVariables type to include epicId and epicTitle",
				"Update createPromptGenerator to accept epic info",
				"Remove story-specific prompt generation",
				"typecheck passes"
			],
			"priority": 19,
			"passes": false,
			"notes": ""
		},
		{
			"id": "US-051",
			"title": "Update README for beads workflow",
			"acceptanceCriteria": [
				"Update readme.md to document beads-based workflow",
				"Document epic selection at startup",
				"Document branch management (auto-derived from epic title)",
				"Remove prd.json documentation",
				"Add beads prerequisites (bd CLI installed)",
				"Update quick start for beads workflow",
				"Document keyboard controls for epic/task navigation"
			],
			"priority": 20,
			"passes": false,
			"notes": ""
		}
	]
}
